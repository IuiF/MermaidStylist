<!DOCTYPE html>
<html>
<head>
    <title>Mermaid Tree</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .tree-container {
            position: relative;
            width: 100%;
            height: 800px;
            overflow: auto;
            border: 1px solid #ddd;
            background: #fafafa;
        }
        .node {
            position: absolute;
            border: 2px solid #333;
            background: #f9f9f9;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            cursor: pointer;
        }
        .connection-line {
            position: absolute;
            background-color: #666;
            transform-origin: left center;
            height: 2px;
            z-index: 1;
        }
        .connection-line::after {
            content: '';
            position: absolute;
            right: -8px;
            top: -3px;
            width: 0;
            height: 0;
            border-left: 8px solid #666;
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
        }
        .node {
            z-index: 2;
        }
    </style>
</head>
<body>
    <h1>Tree Structure</h1>
    <div class="tree-container" id="treeContainer">
        <div class="node" id="id_0" data-label="HE0320">HE0320</div>
        <div class="node" id="id_1" data-label="HE0560">HE0560</div>
        <div class="node" id="id_2" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_3" data-label="HJ1130">HJ1130</div>
        <div class="node" id="id_4" data-label="HJ0300">HJ0300</div>
        <div class="node" id="id_5" data-label="UK0782">UK0782</div>
        <div class="node" id="id_6" data-label="UK0790">UK0790</div>
        <div class="node" id="id_7" data-label="BS2000">BS2000</div>
        <div class="node" id="id_8" data-label="HN0220">HN0220</div>
        <div class="node" id="id_9" data-label="HN0230">HN0230</div>
        <div class="node" id="id_10" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_11" data-label="HN9710">HN9710</div>
        <div class="node" id="id_12" data-label="UK0095">UK0095</div>
        <div class="node" id="id_13" data-label="UK0810">UK0810</div>
        <div class="node" id="id_14" data-label="UK0810">UK0810</div>
        <div class="node" id="id_15" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_16" data-label="HN9710">HN9710</div>
        <div class="node" id="id_17" data-label="HN0291">HN0291</div>
        <div class="node" id="id_18" data-label="HN4641">HN4641</div>
        <div class="node" id="id_19" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_20" data-label="HN6390">HN6390</div>
        <div class="node" id="id_21" data-label="HN6400">HN6400</div>
        <div class="node" id="id_22" data-label="HN6200">HN6200</div>
        <div class="node" id="id_23" data-label="HN6410">HN6410</div>
        <div class="node" id="id_24" data-label="HN6420">HN6420</div>
        <div class="node" id="id_25" data-label="ZU0170">ZU0170</div>
        <div class="node" id="id_26" data-label="HN4640">HN4640</div>
        <div class="node" id="id_27" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_28" data-label="HN8310">HN8310</div>
        <div class="node" id="id_29" data-label="HN8380">HN8380</div>
        <div class="node" id="id_30" data-label="HN8530">HN8530</div>
        <div class="node" id="id_31" data-label="HN8540">HN8540</div>
        <div class="node" id="id_32" data-label="HN8540">HN8540</div>
        <div class="node" id="id_33" data-label="HN6940">HN6940</div>
        <div class="node" id="id_34" data-label="HN3860">HN3860</div>
        <div class="node" id="id_35" data-label="HN6910">HN6910</div>
        <div class="node" id="id_36" data-label="HN4640">HN4640</div>
        <div class="node" id="id_37" data-label="HN4230">HN4230</div>
        <div class="node" id="id_38" data-label="HN4060">HN4060</div>
        <div class="node" id="id_39" data-label="HN5290">HN5290</div>
        <div class="node" id="id_40" data-label="HN6390">HN6390</div>
        <div class="node" id="id_41" data-label="HN6411">HN6411</div>
        <div class="node" id="id_42" data-label="HN7310">HN7310</div>
        <div class="node" id="id_43" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_44" data-label="HN6412">HN6412</div>
        <div class="node" id="id_45" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_46" data-label="HN9710">HN9710</div>
        <div class="node" id="id_47" data-label="HN0291">HN0291</div>
        <div class="node" id="id_48" data-label="HN0280">HN0280</div>
        <div class="node" id="id_49" data-label="HN0710">HN0710</div>
        <div class="node" id="id_50" data-label="HN0291">HN0291</div>
        <div class="node" id="id_51" data-label="HK0210">HK0210</div>
        <div class="node" id="id_52" data-label="MR0210">MR0210</div>
        <div class="node" id="id_53" data-label="ZU0110">ZU0110</div>
        <div class="node" id="id_54" data-label="MJ0110">MJ0110</div>
        <div class="node" id="id_55" data-label="MK0410">MK0410</div>
        <div class="node" id="id_56" data-label="SS0710">SS0710</div>
        <div class="node" id="id_57" data-label="MK0430">MK0430</div>
        <div class="node" id="id_58" data-label="HN7000">HN7000</div>
        <div class="node" id="id_59" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_60" data-label="HK214800">HK214800</div>
        <div class="node" id="id_61" data-label="HK0210">HK0210</div>
        <div class="node" id="id_62" data-label="MR0250">MR0250</div>
        <div class="node" id="id_63" data-label="SS0710">SS0710</div>
        <div class="node" id="id_64" data-label="MJ0110">MJ0110</div>
        <div class="node" id="id_65" data-label="SS0710">SS0710</div>
        <div class="node" id="id_66" data-label="MK0430">MK0430</div>
        <div class="node" id="id_67" data-label="MJ0520">MJ0520</div>
        <div class="node" id="id_68" data-label="UK0782">UK0782</div>
        <div class="node" id="id_69" data-label="HN0291">HN0291</div>
        <div class="node" id="id_70" data-label="BK9850">BK9850</div>
        <div class="node" id="id_71" data-label="UK9910">UK9910</div>
        <div class="node" id="id_72" data-label="HN6830">HN6830</div>
        <div class="node" id="id_73" data-label="HN8100">HN8100</div>
        <div class="node" id="id_74" data-label="HN5620">HN5620</div>
        <div class="node" id="id_75" data-label="HN4290">HN4290</div>
        <div class="node" id="id_76" data-label="HN4640">HN4640</div>
        <div class="node" id="id_77" data-label="HN8310">HN8310</div>
        <div class="node" id="id_78" data-label="HN6630">HN6630</div>
        <div class="node" id="id_79" data-label="HN8380">HN8380</div>
        <div class="node" id="id_80" data-label="HN5621">HN5621</div>
        <div class="node" id="id_81" data-label="HN8440">HN8440</div>
        <div class="node" id="id_82" data-label="複数回登場につき省略">複数回登場につき省略</div>
        <div class="node" id="id_83" data-label="HN0250">HN0250</div>
        <div class="node" id="id_84" data-label="HN4640">HN4640</div>
        <div class="node" id="id_85" data-label="HN8540">HN8540</div>
        <div class="node" id="id_86" data-label="HN8540">HN8540</div>
        <div class="node" id="id_87" data-label="HN0300">HN0300</div>
        <div class="node" id="id_88" data-label="HN6290">HN6290</div>
        <div class="node" id="id_89" data-label="UK0710">UK0710</div>
        <div class="node" id="id_90" data-label="HN6360">HN6360</div>
        <div class="node" id="id_91" data-label="HN0150">HN0150</div>
        <div class="node" id="id_92" data-label="HN0151">HN0151</div>
        <div class="node" id="id_93" data-label="UK0570">UK0570</div>
        <div class="node" id="id_94" data-label="HN6350">HN6350</div>
        <div class="node" id="id_95" data-label="複数回登場につき省略">複数回登場につき省略</div>
        <div class="node" id="id_96" data-label="HN6340">HN6340</div>
        <div class="node" id="id_97" data-label="HE0470">HE0470</div>
        <div class="node" id="id_98" data-label="HN6000">HN6000</div>
        <div class="node" id="id_99" data-label="HN6290">HN6290</div>
        <div class="node" id="id_100" data-label="HN6830">HN6830</div>
        <div class="node" id="id_101" data-label="ZU0110">ZU0110</div>
        <div class="node" id="id_102" data-label="SS0610">SS0610</div>
        <div class="node" id="id_103" data-label="HN6830">HN6830</div>
        <div class="node" id="id_104" data-label="HN8100">HN8100</div>
        <div class="node" id="id_105" data-label="HN0280">HN0280</div>
        <div class="node" id="id_106" data-label="MJ0110">MJ0110</div>
        <div class="node" id="id_107" data-label="SS0710">SS0710</div>
        <div class="node" id="id_108" data-label="MK0430">MK0430</div>
        <div class="node" id="id_109" data-label="MJ0520">MJ0520</div>
        <div class="node" id="id_110" data-label="UK0782">UK0782</div>
        <div class="node" id="id_111" data-label="UK0790">UK0790</div>
        <div class="node" id="id_112" data-label="HN0291">HN0291</div>
        <div class="node" id="id_113" data-label="HN6900">HN6900</div>
        <div class="node" id="id_114" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_115" data-label="HN9710">HN9710</div>
        <div class="node" id="id_116" data-label="HN0291">HN0291</div>
        <div class="node" id="id_117" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_118" data-label="MK0430">MK0430</div>
        <div class="node" id="id_119" data-label="DENCTL">DENCTL</div>
        <div class="node" id="id_120" data-label="MK0430">MK0430</div>
        <div class="node" id="id_121" data-label="BS2000">BS2000</div>
        <div class="node" id="id_122" data-label="BS200200">BS200200</div>
        <div class="node" id="id_123" data-label="HJ9820">HJ9820</div>
        <div class="node" id="id_124" data-label="UK0810">UK0810</div>
        <div class="node" id="id_125" data-label="HJ1140">HJ1140</div>
        <div class="node" id="id_126" data-label="UK1780">UK1780</div>
        <div class="node" id="id_127" data-label="UK1790">UK1790</div>
        <div class="node" id="id_128" data-label="HJ9810">HJ9810</div>
        <div class="node" id="id_129" data-label="HJ9830">HJ9830</div>
        <div class="node" id="id_130" data-label="BS2440">BS2440</div>
        <div class="node" id="id_131" data-label="BS2120">BS2120</div>
        <div class="node" id="id_132" data-label="BS2130">BS2130</div>
        <div class="node" id="id_133" data-label="BS0680">BS0680</div>
        <div class="node" id="id_134" data-label="UK3020">UK3020</div>
        <div class="node" id="id_135" data-label="BS2240">BS2240</div>
        <div class="node" id="id_136" data-label="UK0810">UK0810</div>
        <div class="node" id="id_137" data-label="UK0810">UK0810</div>
        <div class="node" id="id_138" data-label="BS2220">BS2220</div>
        <div class="node" id="id_139" data-label="UK1140">UK1140</div>
        <div class="node" id="id_140" data-label="UK0810">UK0810</div>
        <div class="node" id="id_141" data-label="UK0810">UK0810</div>
        <div class="node" id="id_142" data-label="BS2960">BS2960</div>
        <div class="node" id="id_143" data-label="UK0810">UK0810</div>
        <div class="node" id="id_144" data-label="UK0810">UK0810</div>
        <div class="node" id="id_145" data-label="UK0810">UK0810</div>
        <div class="node" id="id_146" data-label="BS3050">BS3050</div>
        <div class="node" id="id_147" data-label="UK0810">UK0810</div>
        <div class="node" id="id_148" data-label="UK0810">UK0810</div>
        <div class="node" id="id_149" data-label="UK0810">UK0810</div>
        <div class="node" id="id_150" data-label="BS2070">BS2070</div>
        <div class="node" id="id_151" data-label="BS2134">BS2134</div>
        <div class="node" id="id_152" data-label="BS2136">BS2136</div>
        <div class="node" id="id_153" data-label="BS0690">BS0690</div>
        <div class="node" id="id_154" data-label="BT0220">BT0220</div>
        <div class="node" id="id_155" data-label="BT0250">BT0250</div>
        <div class="node" id="id_156" data-label="BT0320">BT0320</div>
        <div class="node" id="id_157" data-label="UK0810">UK0810</div>
        <div class="node" id="id_158" data-label="BT0330">BT0330</div>
        <div class="node" id="id_159" data-label="UK0810">UK0810</div>
        <div class="node" id="id_160" data-label="BS2450">BS2450</div>
        <div class="node" id="id_161" data-label="BS2140">BS2140</div>
        <div class="node" id="id_162" data-label="BS2100">BS2100</div>
        <div class="node" id="id_163" data-label="BS2950">BS2950</div>
        <div class="node" id="id_164" data-label="UK3020">UK3020</div>
        <div class="node" id="id_165" data-label="HN5320">HN5320</div>
        <div class="node" id="id_166" data-label="HN5321">HN5321</div>
        <div class="node" id="id_167" data-label="HN220105">HN220105</div>
        <div class="node" id="id_168" data-label="HN2210">HN2210</div>
        <div class="node" id="id_169" data-label="HN0230">HN0230</div>
        <div class="node" id="id_170" data-label="HN2211">HN2211</div>
        <div class="node" id="id_171" data-label="HN220102">HN220102</div>
        <div class="node" id="id_172" data-label="BS3260">BS3260</div>
        <div class="node" id="id_173" data-label="UK3020">UK3020</div>
        <div class="node" id="id_174" data-label="BS2260">BS2260</div>
        <div class="node" id="id_175" data-label="BS9860">BS9860</div>
        <div class="node" id="id_176" data-label="UK9910">UK9910</div>
        <div class="node" id="id_177" data-label="BS2190">BS2190</div>
        <div class="node" id="id_178" data-label="UK0810">UK0810</div>
        <div class="node" id="id_179" data-label="BS2230">BS2230</div>
        <div class="node" id="id_180" data-label="BS9740">BS9740</div>
        <div class="node" id="id_181" data-label="BS2010">BS2010</div>
        <div class="node" id="id_182" data-label="BS1820">BS1820</div>
        <div class="node" id="id_183" data-label="UK3020">UK3020</div>
        <div class="node" id="id_184" data-label="BS1830">BS1830</div>
        <div class="node" id="id_185" data-label="BS1880">BS1880</div>
        <div class="node" id="id_186" data-label="BS3120">BS3120</div>
        <div class="node" id="id_187" data-label="UK3020">UK3020</div>
        <div class="node" id="id_188" data-label="BS3121">BS3121</div>
        <div class="node" id="id_189" data-label="BS3122">BS3122</div>
        <div class="node" id="id_190" data-label="BS316602">BS316602</div>
        <div class="node" id="id_191" data-label="BS2020">BS2020</div>
        <div class="node" id="id_192" data-label="BS1930">BS1930</div>
        <div class="node" id="id_193" data-label="UK0810">UK0810</div>
        <div class="node" id="id_194" data-label="HE1130">HE1130</div>
        <div class="node" id="id_195" data-label="HE1130">HE1130</div>
        <div class="node" id="id_196" data-label="HE1130">HE1130</div>
        <div class="node" id="id_197" data-label="BS2460">BS2460</div>
        <div class="node" id="id_198" data-label="BS2420">BS2420</div>
        <div class="node" id="id_199" data-label="BS2435">BS2435</div>
        <div class="node" id="id_200" data-label="BS977000BJ">BS977000BJ</div>
        <div class="node" id="id_201" data-label="BS1820">BS1820</div>
        <div class="node" id="id_202" data-label="BS2138">BS2138</div>
        <div class="node" id="id_203" data-label="BS2490">BS2490</div>
        <div class="node" id="id_204" data-label="BS2570">BS2570</div>
        <div class="node" id="id_205" data-label="UK0810">UK0810</div>
        <div class="node" id="id_206" data-label="BS2050">BS2050</div>
        <div class="node" id="id_207" data-label="UK0810">UK0810</div>
        <div class="node" id="id_208" data-label="BS2560">BS2560</div>
        <div class="node" id="id_209" data-label="BS2561">BS2561</div>
        <div class="node" id="id_210" data-label="BS3010">BS3010</div>
        <div class="node" id="id_211" data-label="BS1930">BS1930</div>
        <div class="node" id="id_212" data-label="UK0810">UK0810</div>
        <div class="node" id="id_213" data-label="BS3130">BS3130</div>
        <div class="node" id="id_214" data-label="BS3131">BS3131</div>
        <div class="node" id="id_215" data-label="BS2270">BS2270</div>
        <div class="node" id="id_216" data-label="BS9740">BS9740</div>
        <div class="node" id="id_217" data-label="UK0810">UK0810</div>
        <div class="node" id="id_218" data-label="BS3230">BS3230</div>
        <div class="node" id="id_219" data-label="HN0730">HN0730</div>
        <div class="node" id="id_220" data-label="BS2580">BS2580</div>
        <div class="node" id="id_221" data-label="HN2710">HN2710</div>
        <div class="node" id="id_222" data-label="HN272000">HN272000</div>
        <div class="node" id="id_223" data-label="HN6200">HN6200</div>
        <div class="node" id="id_224" data-label="HE132000">HE132000</div>
        <div class="node" id="id_225" data-label="BS2010">BS2010</div>
        <div class="node" id="id_226" data-label="BS2020">BS2020</div>
        <div class="node" id="id_227" data-label="BS2130">BS2130</div>
        <div class="node" id="id_228" data-label="BS2050">BS2050</div>
        <div class="node" id="id_229" data-label="BS0680">BS0680</div>
        <div class="node" id="id_230" data-label="BS9740">BS9740</div>
        <div class="node" id="id_231" data-label="BH011100">BH011100</div>
        <div class="node" id="id_232" data-label="BS228000">BS228000</div>
        <div class="node" id="id_233" data-label="BS401000">BS401000</div>
        <div class="node" id="id_234" data-label="BS9740">BS9740</div>
        <div class="node" id="id_235" data-label="BS2136">BS2136</div>
        <div class="node" id="id_236" data-label="BS0690">BS0690</div>
        <div class="node" id="id_237" data-label="HJ1120">HJ1120</div>
        <div class="node" id="id_238" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_239" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_240" data-label="UK0782">UK0782</div>
        <div class="node" id="id_241" data-label="UK0790">UK0790</div>
        <div class="node" id="id_242" data-label="HJ1410">HJ1410</div>
        <div class="node" id="id_243" data-label="UK0810">UK0810</div>
        <div class="node" id="id_244" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_245" data-label="HJ126500">HJ126500</div>
        <div class="node" id="id_246" data-label="HE9000">HE9000</div>
        <div class="node" id="id_247" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_248" data-label="UK0782">UK0782</div>
        <div class="node" id="id_249" data-label="UK0790">UK0790</div>
        <div class="node" id="id_250" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_251" data-label="HE9000">HE9000</div>
        <div class="node" id="id_252" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_253" data-label="UK0782">UK0782</div>
        <div class="node" id="id_254" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_255" data-label="HE9000">HE9000</div>
        <div class="node" id="id_256" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_257" data-label="UK0782">UK0782</div>
        <div class="node" id="id_258" data-label="HE0520">HE0520</div>
        <div class="node" id="id_259" data-label="UK0782">UK0782</div>
        <div class="node" id="id_260" data-label="HE0510">HE0510</div>
        <div class="node" id="id_261" data-label="HE0740">HE0740</div>
        <div class="node" id="id_262" data-label="UK0782">UK0782</div>
        <div class="node" id="id_263" data-label="最新に存在しない？">最新に存在しない？</div>
        <div class="node" id="id_264" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_265" data-label="HE9000">HE9000</div>
        <div class="node" id="id_266" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_267" data-label="最新に存在しない？">最新に存在しない？</div>
        <div class="node" id="id_268" data-label="HE0570">HE0570</div>
        <div class="node" id="id_269" data-label="HJ1110">HJ1110</div>
        <div class="node" id="id_270" data-label="HE9000">HE9000</div>
        <div class="node" id="id_271" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_272" data-label="HJ1580">HJ1580</div>
        <div class="node" id="id_273" data-label="HJ1130">HJ1130</div>
        <div class="node" id="id_274" data-label="HJ128000">HJ128000</div>
        <div class="node" id="id_275" data-label="HJ1140">HJ1140</div>
        <div class="node" id="id_276" data-label="HJ9860">HJ9860</div>
        <div class="node" id="id_277" data-label="HE0580">HE0580</div>
    </div>
    <script>
        const nodes = [{"id":"id_0","label":"HE0320"},{"id":"id_1","label":"HE0560"},{"id":"id_2","label":"HJ1110"},{"id":"id_3","label":"HJ1130"},{"id":"id_4","label":"HJ0300"},{"id":"id_5","label":"UK0782"},{"id":"id_6","label":"UK0790"},{"id":"id_7","label":"BS2000"},{"id":"id_8","label":"HN0220"},{"id":"id_9","label":"HN0230"},{"id":"id_10","label":"DENCTL"},{"id":"id_11","label":"HN9710"},{"id":"id_12","label":"UK0095"},{"id":"id_13","label":"UK0810"},{"id":"id_14","label":"UK0810"},{"id":"id_15","label":"DENCTL"},{"id":"id_16","label":"HN9710"},{"id":"id_17","label":"HN0291"},{"id":"id_18","label":"HN4641"},{"id":"id_19","label":"DENCTL"},{"id":"id_20","label":"HN6390"},{"id":"id_21","label":"HN6400"},{"id":"id_22","label":"HN6200"},{"id":"id_23","label":"HN6410"},{"id":"id_24","label":"HN6420"},{"id":"id_25","label":"ZU0170"},{"id":"id_26","label":"HN4640"},{"id":"id_27","label":"DENCTL"},{"id":"id_28","label":"HN8310"},{"id":"id_29","label":"HN8380"},{"id":"id_30","label":"HN8530"},{"id":"id_31","label":"HN8540"},{"id":"id_32","label":"HN8540"},{"id":"id_33","label":"HN6940"},{"id":"id_34","label":"HN3860"},{"id":"id_35","label":"HN6910"},{"id":"id_36","label":"HN4640"},{"id":"id_37","label":"HN4230"},{"id":"id_38","label":"HN4060"},{"id":"id_39","label":"HN5290"},{"id":"id_40","label":"HN6390"},{"id":"id_41","label":"HN6411"},{"id":"id_42","label":"HN7310"},{"id":"id_43","label":"DENCTL"},{"id":"id_44","label":"HN6412"},{"id":"id_45","label":"DENCTL"},{"id":"id_46","label":"HN9710"},{"id":"id_47","label":"HN0291"},{"id":"id_48","label":"HN0280"},{"id":"id_49","label":"HN0710"},{"id":"id_50","label":"HN0291"},{"id":"id_51","label":"HK0210"},{"id":"id_52","label":"MR0210"},{"id":"id_53","label":"ZU0110"},{"id":"id_54","label":"MJ0110"},{"id":"id_55","label":"MK0410"},{"id":"id_56","label":"SS0710"},{"id":"id_57","label":"MK0430"},{"id":"id_58","label":"HN7000"},{"id":"id_59","label":"DENCTL"},{"id":"id_60","label":"HK214800"},{"id":"id_61","label":"HK0210"},{"id":"id_62","label":"MR0250"},{"id":"id_63","label":"SS0710"},{"id":"id_64","label":"MJ0110"},{"id":"id_65","label":"SS0710"},{"id":"id_66","label":"MK0430"},{"id":"id_67","label":"MJ0520"},{"id":"id_68","label":"UK0782"},{"id":"id_69","label":"HN0291"},{"id":"id_70","label":"BK9850"},{"id":"id_71","label":"UK9910"},{"id":"id_72","label":"HN6830"},{"id":"id_73","label":"HN8100"},{"id":"id_74","label":"HN5620"},{"id":"id_75","label":"HN4290"},{"id":"id_76","label":"HN4640"},{"id":"id_77","label":"HN8310"},{"id":"id_78","label":"HN6630"},{"id":"id_79","label":"HN8380"},{"id":"id_80","label":"HN5621"},{"id":"id_81","label":"HN8440"},{"id":"id_82","label":"複数回登場につき省略"},{"id":"id_83","label":"HN0250"},{"id":"id_84","label":"HN4640"},{"id":"id_85","label":"HN8540"},{"id":"id_86","label":"HN8540"},{"id":"id_87","label":"HN0300"},{"id":"id_88","label":"HN6290"},{"id":"id_89","label":"UK0710"},{"id":"id_90","label":"HN6360"},{"id":"id_91","label":"HN0150"},{"id":"id_92","label":"HN0151"},{"id":"id_93","label":"UK0570"},{"id":"id_94","label":"HN6350"},{"id":"id_95","label":"複数回登場につき省略"},{"id":"id_96","label":"HN6340"},{"id":"id_97","label":"HE0470"},{"id":"id_98","label":"HN6000"},{"id":"id_99","label":"HN6290"},{"id":"id_100","label":"HN6830"},{"id":"id_101","label":"ZU0110"},{"id":"id_102","label":"SS0610"},{"id":"id_103","label":"HN6830"},{"id":"id_104","label":"HN8100"},{"id":"id_105","label":"HN0280"},{"id":"id_106","label":"MJ0110"},{"id":"id_107","label":"SS0710"},{"id":"id_108","label":"MK0430"},{"id":"id_109","label":"MJ0520"},{"id":"id_110","label":"UK0782"},{"id":"id_111","label":"UK0790"},{"id":"id_112","label":"HN0291"},{"id":"id_113","label":"HN6900"},{"id":"id_114","label":"DENCTL"},{"id":"id_115","label":"HN9710"},{"id":"id_116","label":"HN0291"},{"id":"id_117","label":"DENCTL"},{"id":"id_118","label":"MK0430"},{"id":"id_119","label":"DENCTL"},{"id":"id_120","label":"MK0430"},{"id":"id_121","label":"BS2000"},{"id":"id_122","label":"BS200200"},{"id":"id_123","label":"HJ9820"},{"id":"id_124","label":"UK0810"},{"id":"id_125","label":"HJ1140"},{"id":"id_126","label":"UK1780"},{"id":"id_127","label":"UK1790"},{"id":"id_128","label":"HJ9810"},{"id":"id_129","label":"HJ9830"},{"id":"id_130","label":"BS2440"},{"id":"id_131","label":"BS2120"},{"id":"id_132","label":"BS2130"},{"id":"id_133","label":"BS0680"},{"id":"id_134","label":"UK3020"},{"id":"id_135","label":"BS2240"},{"id":"id_136","label":"UK0810"},{"id":"id_137","label":"UK0810"},{"id":"id_138","label":"BS2220"},{"id":"id_139","label":"UK1140"},{"id":"id_140","label":"UK0810"},{"id":"id_141","label":"UK0810"},{"id":"id_142","label":"BS2960"},{"id":"id_143","label":"UK0810"},{"id":"id_144","label":"UK0810"},{"id":"id_145","label":"UK0810"},{"id":"id_146","label":"BS3050"},{"id":"id_147","label":"UK0810"},{"id":"id_148","label":"UK0810"},{"id":"id_149","label":"UK0810"},{"id":"id_150","label":"BS2070"},{"id":"id_151","label":"BS2134"},{"id":"id_152","label":"BS2136"},{"id":"id_153","label":"BS0690"},{"id":"id_154","label":"BT0220"},{"id":"id_155","label":"BT0250"},{"id":"id_156","label":"BT0320"},{"id":"id_157","label":"UK0810"},{"id":"id_158","label":"BT0330"},{"id":"id_159","label":"UK0810"},{"id":"id_160","label":"BS2450"},{"id":"id_161","label":"BS2140"},{"id":"id_162","label":"BS2100"},{"id":"id_163","label":"BS2950"},{"id":"id_164","label":"UK3020"},{"id":"id_165","label":"HN5320"},{"id":"id_166","label":"HN5321"},{"id":"id_167","label":"HN220105"},{"id":"id_168","label":"HN2210"},{"id":"id_169","label":"HN0230"},{"id":"id_170","label":"HN2211"},{"id":"id_171","label":"HN220102"},{"id":"id_172","label":"BS3260"},{"id":"id_173","label":"UK3020"},{"id":"id_174","label":"BS2260"},{"id":"id_175","label":"BS9860"},{"id":"id_176","label":"UK9910"},{"id":"id_177","label":"BS2190"},{"id":"id_178","label":"UK0810"},{"id":"id_179","label":"BS2230"},{"id":"id_180","label":"BS9740"},{"id":"id_181","label":"BS2010"},{"id":"id_182","label":"BS1820"},{"id":"id_183","label":"UK3020"},{"id":"id_184","label":"BS1830"},{"id":"id_185","label":"BS1880"},{"id":"id_186","label":"BS3120"},{"id":"id_187","label":"UK3020"},{"id":"id_188","label":"BS3121"},{"id":"id_189","label":"BS3122"},{"id":"id_190","label":"BS316602"},{"id":"id_191","label":"BS2020"},{"id":"id_192","label":"BS1930"},{"id":"id_193","label":"UK0810"},{"id":"id_194","label":"HE1130"},{"id":"id_195","label":"HE1130"},{"id":"id_196","label":"HE1130"},{"id":"id_197","label":"BS2460"},{"id":"id_198","label":"BS2420"},{"id":"id_199","label":"BS2435"},{"id":"id_200","label":"BS977000BJ"},{"id":"id_201","label":"BS1820"},{"id":"id_202","label":"BS2138"},{"id":"id_203","label":"BS2490"},{"id":"id_204","label":"BS2570"},{"id":"id_205","label":"UK0810"},{"id":"id_206","label":"BS2050"},{"id":"id_207","label":"UK0810"},{"id":"id_208","label":"BS2560"},{"id":"id_209","label":"BS2561"},{"id":"id_210","label":"BS3010"},{"id":"id_211","label":"BS1930"},{"id":"id_212","label":"UK0810"},{"id":"id_213","label":"BS3130"},{"id":"id_214","label":"BS3131"},{"id":"id_215","label":"BS2270"},{"id":"id_216","label":"BS9740"},{"id":"id_217","label":"UK0810"},{"id":"id_218","label":"BS3230"},{"id":"id_219","label":"HN0730"},{"id":"id_220","label":"BS2580"},{"id":"id_221","label":"HN2710"},{"id":"id_222","label":"HN272000"},{"id":"id_223","label":"HN6200"},{"id":"id_224","label":"HE132000"},{"id":"id_225","label":"BS2010"},{"id":"id_226","label":"BS2020"},{"id":"id_227","label":"BS2130"},{"id":"id_228","label":"BS2050"},{"id":"id_229","label":"BS0680"},{"id":"id_230","label":"BS9740"},{"id":"id_231","label":"BH011100"},{"id":"id_232","label":"BS228000"},{"id":"id_233","label":"BS401000"},{"id":"id_234","label":"BS9740"},{"id":"id_235","label":"BS2136"},{"id":"id_236","label":"BS0690"},{"id":"id_237","label":"HJ1120"},{"id":"id_238","label":"HJ1110"},{"id":"id_239","label":"HJ9860"},{"id":"id_240","label":"UK0782"},{"id":"id_241","label":"UK0790"},{"id":"id_242","label":"HJ1410"},{"id":"id_243","label":"UK0810"},{"id":"id_244","label":"HJ9860"},{"id":"id_245","label":"HJ126500"},{"id":"id_246","label":"HE9000"},{"id":"id_247","label":"HJ9860"},{"id":"id_248","label":"UK0782"},{"id":"id_249","label":"UK0790"},{"id":"id_250","label":"HJ1110"},{"id":"id_251","label":"HE9000"},{"id":"id_252","label":"HJ9860"},{"id":"id_253","label":"UK0782"},{"id":"id_254","label":"HJ1110"},{"id":"id_255","label":"HE9000"},{"id":"id_256","label":"HJ9860"},{"id":"id_257","label":"UK0782"},{"id":"id_258","label":"HE0520"},{"id":"id_259","label":"UK0782"},{"id":"id_260","label":"HE0510"},{"id":"id_261","label":"HE0740"},{"id":"id_262","label":"UK0782"},{"id":"id_263","label":"最新に存在しない？"},{"id":"id_264","label":"HJ1110"},{"id":"id_265","label":"HE9000"},{"id":"id_266","label":"HJ9860"},{"id":"id_267","label":"最新に存在しない？"},{"id":"id_268","label":"HE0570"},{"id":"id_269","label":"HJ1110"},{"id":"id_270","label":"HE9000"},{"id":"id_271","label":"HJ9860"},{"id":"id_272","label":"HJ1580"},{"id":"id_273","label":"HJ1130"},{"id":"id_274","label":"HJ128000"},{"id":"id_275","label":"HJ1140"},{"id":"id_276","label":"HJ9860"},{"id":"id_277","label":"HE0580"}];
        const connections = [{"from":"id_131","to":"id_229"},{"from":"id_182","to":"id_188"},{"from":"id_3","to":"id_7"},{"from":"id_9","to":"id_15"},{"from":"id_21","to":"id_22"},{"from":"id_17","to":"id_101"},{"from":"id_3","to":"id_129"},{"from":"id_17","to":"id_79"},{"from":"id_268","to":"id_270"},{"from":"id_210","to":"id_211"},{"from":"id_88","to":"id_92"},{"from":"id_272","to":"id_274"},{"from":"id_17","to":"id_25"},{"from":"id_98","to":"id_99"},{"from":"id_180","to":"id_182"},{"from":"id_17","to":"id_37"},{"from":"id_131","to":"id_210"},{"from":"id_131","to":"id_218"},{"from":"id_133","to":"id_148"},{"from":"id_1","to":"id_261"},{"from":"id_189","to":"id_190"},{"from":"id_135","to":"id_136"},{"from":"id_58","to":"id_59"},{"from":"id_131","to":"id_230"},{"from":"id_1","to":"id_252"},{"from":"id_135","to":"id_137"},{"from":"id_17","to":"id_36"},{"from":"id_1","to":"id_250"},{"from":"id_2","to":"id_237"},{"from":"id_133","to":"id_146"},{"from":"id_7","to":"id_8"},{"from":"id_17","to":"id_72"},{"from":"id_182","to":"id_185"},{"from":"id_135","to":"id_140"},{"from":"id_158","to":"id_159"},{"from":"id_1","to":"id_262"},{"from":"id_17","to":"id_26"},{"from":"id_17","to":"id_78"},{"from":"id_182","to":"id_186"},{"from":"id_17","to":"id_21"},{"from":"id_17","to":"id_96"},{"from":"id_204","to":"id_207"},{"from":"id_160","to":"id_161"},{"from":"id_180","to":"id_191"},{"from":"id_17","to":"id_32"},{"from":"id_8","to":"id_123"},{"from":"id_17","to":"id_18"},{"from":"id_17","to":"id_85"},{"from":"id_272","to":"id_275"},{"from":"id_161","to":"id_162"},{"from":"id_44","to":"id_48"},{"from":"id_17","to":"id_75"},{"from":"id_18","to":"id_19"},{"from":"id_161","to":"id_174"},{"from":"id_182","to":"id_187"},{"from":"id_17","to":"id_88"},{"from":"id_2","to":"id_3"},{"from":"id_17","to":"id_81"},{"from":"id_131","to":"id_233"},{"from":"id_108","to":"id_110"},{"from":"id_17","to":"id_44"},{"from":"id_131","to":"id_220"},{"from":"id_9","to":"id_119"},{"from":"id_1","to":"id_267"},{"from":"id_0","to":"id_277"},{"from":"id_44","to":"id_47"},{"from":"id_48","to":"id_62"},{"from":"id_242","to":"id_243"},{"from":"id_1","to":"id_256"},{"from":"id_153","to":"id_154"},{"from":"id_17","to":"id_73"},{"from":"id_88","to":"id_89"},{"from":"id_1","to":"id_258"},{"from":"id_268","to":"id_271"},{"from":"id_272","to":"id_273"},{"from":"id_48","to":"id_53"},{"from":"id_17","to":"id_20"},{"from":"id_216","to":"id_217"},{"from":"id_96","to":"id_97"},{"from":"id_191","to":"id_194"},{"from":"id_222","to":"id_227"},{"from":"id_240","to":"id_241"},{"from":"id_48","to":"id_56"},{"from":"id_9","to":"id_120"},{"from":"id_9","to":"id_115"},{"from":"id_48","to":"id_51"},{"from":"id_130","to":"id_131"},{"from":"id_131","to":"id_133"},{"from":"id_163","to":"id_166"},{"from":"id_17","to":"id_40"},{"from":"id_9","to":"id_16"},{"from":"id_17","to":"id_87"},{"from":"id_133","to":"id_145"},{"from":"id_81","to":"id_82"},{"from":"id_210","to":"id_214"},{"from":"id_1","to":"id_255"},{"from":"id_17","to":"id_84"},{"from":"id_88","to":"id_94"},{"from":"id_131","to":"id_151"},{"from":"id_222","to":"id_226"},{"from":"id_154","to":"id_156"},{"from":"id_170","to":"id_171"},{"from":"id_131","to":"id_235"},{"from":"id_70","to":"id_71"},{"from":"id_1","to":"id_251"},{"from":"id_1","to":"id_257"},{"from":"id_210","to":"id_213"},{"from":"id_191","to":"id_196"},{"from":"id_44","to":"id_45"},{"from":"id_1","to":"id_259"},{"from":"id_268","to":"id_269"},{"from":"id_131","to":"id_201"},{"from":"id_133","to":"id_149"},{"from":"id_135","to":"id_139"},{"from":"id_161","to":"id_163"},{"from":"id_66","to":"id_67"},{"from":"id_26","to":"id_27"},{"from":"id_131","to":"id_160"},{"from":"id_163","to":"id_172"},{"from":"id_133","to":"id_134"},{"from":"id_237","to":"id_239"},{"from":"id_11","to":"id_14"},{"from":"id_17","to":"id_41"},{"from":"id_48","to":"id_57"},{"from":"id_9","to":"id_118"},{"from":"id_133","to":"id_135"},{"from":"id_131","to":"id_216"},{"from":"id_17","to":"id_86"},{"from":"id_48","to":"id_55"},{"from":"id_222","to":"id_225"},{"from":"id_237","to":"id_240"},{"from":"id_133","to":"id_143"},{"from":"id_17","to":"id_100"},{"from":"id_17","to":"id_83"},{"from":"id_1","to":"id_247"},{"from":"id_211","to":"id_212"},{"from":"id_166","to":"id_167"},{"from":"id_17","to":"id_102"},{"from":"id_131","to":"id_232"},{"from":"id_17","to":"id_34"},{"from":"id_9","to":"id_108"},{"from":"id_44","to":"id_46"},{"from":"id_131","to":"id_221"},{"from":"id_9","to":"id_113"},{"from":"id_63","to":"id_64"},{"from":"id_88","to":"id_91"},{"from":"id_168","to":"id_169"},{"from":"id_131","to":"id_152"},{"from":"id_133","to":"id_147"},{"from":"id_131","to":"id_222"},{"from":"id_9","to":"id_11"},{"from":"id_48","to":"id_69"},{"from":"id_172","to":"id_173"},{"from":"id_9","to":"id_10"},{"from":"id_17","to":"id_24"},{"from":"id_131","to":"id_198"},{"from":"id_17","to":"id_76"},{"from":"id_17","to":"id_80"},{"from":"id_8","to":"id_121"},{"from":"id_3","to":"id_4"},{"from":"id_5","to":"id_6"},{"from":"id_9","to":"id_107"},{"from":"id_135","to":"id_138"},{"from":"id_182","to":"id_183"},{"from":"id_8","to":"id_9"},{"from":"id_9","to":"id_117"},{"from":"id_163","to":"id_168"},{"from":"id_48","to":"id_60"},{"from":"id_2","to":"id_244"},{"from":"id_88","to":"id_90"},{"from":"id_3","to":"id_126"},{"from":"id_53","to":"id_54"},{"from":"id_131","to":"id_153"},{"from":"id_177","to":"id_179"},{"from":"id_17","to":"id_98"},{"from":"id_3","to":"id_125"},{"from":"id_1","to":"id_263"},{"from":"id_1","to":"id_253"},{"from":"id_131","to":"id_202"},{"from":"id_17","to":"id_39"},{"from":"id_48","to":"id_58"},{"from":"id_17","to":"id_23"},{"from":"id_191","to":"id_195"},{"from":"id_48","to":"id_66"},{"from":"id_133","to":"id_144"},{"from":"id_30","to":"id_31"},{"from":"id_2","to":"id_245"},{"from":"id_26","to":"id_28"},{"from":"id_131","to":"id_150"},{"from":"id_268","to":"id_272"},{"from":"id_17","to":"id_33"},{"from":"id_48","to":"id_70"},{"from":"id_94","to":"id_95"},{"from":"id_0","to":"id_1"},{"from":"id_8","to":"id_122"},{"from":"id_131","to":"id_132"},{"from":"id_17","to":"id_42"},{"from":"id_163","to":"id_164"},{"from":"id_163","to":"id_165"},{"from":"id_160","to":"id_180"},{"from":"id_1","to":"id_254"},{"from":"id_17","to":"id_38"},{"from":"id_66","to":"id_68"},{"from":"id_237","to":"id_238"},{"from":"id_48","to":"id_50"},{"from":"id_182","to":"id_189"},{"from":"id_131","to":"id_203"},{"from":"id_1","to":"id_2"},{"from":"id_17","to":"id_103"},{"from":"id_154","to":"id_155"},{"from":"id_17","to":"id_77"},{"from":"id_131","to":"id_204"},{"from":"id_222","to":"id_224"},{"from":"id_222","to":"id_228"},{"from":"id_48","to":"id_65"},{"from":"id_17","to":"id_104"},{"from":"id_17","to":"id_74"},{"from":"id_131","to":"id_231"},{"from":"id_204","to":"id_205"},{"from":"id_160","to":"id_177"},{"from":"id_248","to":"id_249"},{"from":"id_110","to":"id_111"},{"from":"id_9","to":"id_112"},{"from":"id_131","to":"id_200"},{"from":"id_161","to":"id_175"},{"from":"id_175","to":"id_176"},{"from":"id_11","to":"id_12"},{"from":"id_17","to":"id_43"},{"from":"id_105","to":"id_106"},{"from":"id_204","to":"id_206"},{"from":"id_131","to":"id_236"},{"from":"id_2","to":"id_242"},{"from":"id_177","to":"id_178"},{"from":"id_133","to":"id_142"},{"from":"id_48","to":"id_61"},{"from":"id_182","to":"id_184"},{"from":"id_108","to":"id_109"},{"from":"id_126","to":"id_127"},{"from":"id_156","to":"id_157"},{"from":"id_12","to":"id_13"},{"from":"id_1","to":"id_248"},{"from":"id_3","to":"id_5"},{"from":"id_9","to":"id_116"},{"from":"id_9","to":"id_17"},{"from":"id_218","to":"id_219"},{"from":"id_48","to":"id_52"},{"from":"id_88","to":"id_93"},{"from":"id_180","to":"id_181"},{"from":"id_123","to":"id_124"},{"from":"id_3","to":"id_128"},{"from":"id_135","to":"id_141"},{"from":"id_131","to":"id_234"},{"from":"id_1","to":"id_268"},{"from":"id_198","to":"id_199"},{"from":"id_192","to":"id_193"},{"from":"id_131","to":"id_197"},{"from":"id_1","to":"id_265"},{"from":"id_191","to":"id_192"},{"from":"id_17","to":"id_35"},{"from":"id_222","to":"id_223"},{"from":"id_131","to":"id_209"},{"from":"id_48","to":"id_63"},{"from":"id_268","to":"id_276"},{"from":"id_26","to":"id_29"},{"from":"id_29","to":"id_30"},{"from":"id_1","to":"id_260"},{"from":"id_131","to":"id_215"},{"from":"id_163","to":"id_170"},{"from":"id_1","to":"id_264"},{"from":"id_154","to":"id_158"},{"from":"id_9","to":"id_114"},{"from":"id_1","to":"id_246"},{"from":"id_131","to":"id_208"},{"from":"id_1","to":"id_266"},{"from":"id_9","to":"id_105"},{"from":"id_3","to":"id_130"},{"from":"id_48","to":"id_49"}];

        function hierarchicalLayout() {
            const container = document.getElementById('treeContainer');
            let containerWidth = Math.max(800, container.clientWidth || 800);

            // 全ノードの幅を事前計算（ラベルごとに統一）
            const nodeWidthMap = calculateAllNodeWidths(nodes);

            // 木構造を解析
            const treeStructure = analyzeTreeStructure(nodes, connections);

            // 必要な最大幅を事前計算
            let maxRequiredWidth = 0;
            treeStructure.levels.forEach(level => {
                const spacing = calculateDynamicSpacing(level, containerWidth, nodeWidthMap);
                const requiredWidth = spacing.totalWidth + 100; // 左右マージン含む
                maxRequiredWidth = Math.max(maxRequiredWidth, requiredWidth);
            });

            // コンテナが狭すぎる場合は拡張
            if (maxRequiredWidth > containerWidth) {
                containerWidth = maxRequiredWidth;
                container.style.width = containerWidth + 'px';
                console.log("Container width expanded to: " + containerWidth + "px");
            }

            // 各階層レベルでノードを配置
            const levelHeight = 80;

            treeStructure.levels.forEach((level, levelIndex) => {
                const y = 50 + levelIndex * levelHeight;

                // 動的間隔計算（containerWidthと事前計算された幅マップを渡す）
                const spacing = calculateDynamicSpacing(level, containerWidth, nodeWidthMap);

                level.forEach((node, nodeIndex) => {
                    const element = document.getElementById(node.id);
                    if (element) {
                        element.style.left = spacing.positions[nodeIndex] + 'px';
                        element.style.top = y + 'px';
                    }
                });
            });
        }

        function measureTextWidth(text, font) {
            // キャンバスを使用して正確な文字幅を測定
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            context.font = font;
            return context.measureText(text).width;
        }

        function calculateAllNodeWidths(nodes) {
            const padding = 24; // ボックスのパディング（左右12pxずつ）
            const nodeWidthMap = new Map();
            const font = '12px Arial, sans-serif'; // CSSで指定されているフォント

            // 全ノードのラベルから幅を計算
            nodes.forEach(node => {
                if (!nodeWidthMap.has(node.label)) {
                    const textWidth = measureTextWidth(node.label, font);
                    const calculatedWidth = Math.ceil(textWidth) + padding;
                    nodeWidthMap.set(node.label, calculatedWidth);

                    // デバッグ：長いラベルの幅計算を出力
                    if (node.label.length > 8) {
                        console.log("Debug: label=" + node.label + ", measured width=" + Math.ceil(textWidth) + "px, total width=" + calculatedWidth + "px");
                    }
                }
            });

            return nodeWidthMap;
        }

        function analyzeTreeStructure(nodes, connections) {
            const childNodes = new Set(connections.map(c => c.to));
            const rootNodes = nodes.filter(node => !childNodes.has(node.id));

            const childrenMap = new Map();
            connections.forEach(conn => {
                if (!childrenMap.has(conn.from)) {
                    childrenMap.set(conn.from, []);
                }
                childrenMap.get(conn.from).push(conn.to);
            });

            const levels = [];
            const visited = new Set();

            if (rootNodes.length > 0) {
                let currentLevel = rootNodes.map(node => node.id);
                let maxDepth = 0;

                while (currentLevel.length > 0 && maxDepth < 50) { // 最大深度制限
                    const levelNodes = currentLevel.map(nodeId => nodes.find(n => n.id === nodeId)).filter(Boolean);
                    levels.push(levelNodes);

                    currentLevel.forEach(nodeId => visited.add(nodeId));

                    const nextLevel = [];
                    currentLevel.forEach(nodeId => {
                        const children = childrenMap.get(nodeId) || [];
                        children.forEach(childId => {
                            if (!visited.has(childId)) {
                                nextLevel.push(childId);
                            }
                        });
                    });

                    currentLevel = [...new Set(nextLevel)];
                    maxDepth++;
                }
            }

            return { rootNodes, levels, childrenMap };
        }

        function calculateDynamicSpacing(nodes, containerWidth = 800, nodeWidthMap) {
            const fixedSpacing = 60; // 固定間隔（ノード端から端まで）
            const leftMargin = 50; // 左端マージン

            // 各ノードの幅を事前計算されたマップから取得
            const nodeWidths = nodes.map(node => {
                return nodeWidthMap.get(node.label);
            });

            if (nodes.length <= 1) {
                const singleNodeX = Math.max(leftMargin, (containerWidth - nodeWidths[0]) / 2);
                return {
                    fixedSpacing,
                    positions: [singleNodeX],
                    nodeWidths,
                    totalWidth: nodeWidths[0] || 0,
                    uniformSpacing: fixedSpacing
                };
            }

            // 固定間隔での総幅を計算
            const totalNodeWidth = nodeWidths.reduce((sum, width) => sum + width, 0);
            const totalSpacingWidth = fixedSpacing * (nodes.length - 1);
            const totalLayoutWidth = totalNodeWidth + totalSpacingWidth;

            // 中央寄せの開始位置を計算（左マージンを下回らないよう調整）
            const idealStartX = (containerWidth - totalLayoutWidth) / 2;
            const startX = Math.max(leftMargin, idealStartX);

            // デバッグ：レイアウト情報を出力
            if (nodes.length > 3) {
                console.log("Layout debug: containerWidth=" + containerWidth + "px, totalLayoutWidth=" + totalLayoutWidth + "px, startX=" + startX + "px");
            }

            const positions = [];
            let currentX = startX;

            for (let i = 0; i < nodes.length; i++) {
                positions.push(currentX);
                currentX += nodeWidths[i] + fixedSpacing;
            }

            return {
                fixedSpacing,
                positions,
                nodeWidths,
                totalWidth: totalLayoutWidth,
                uniformSpacing: fixedSpacing,
                actualStartX: startX
            };
        }

        function createCSSLines() {
            const container = document.getElementById('treeContainer');
            if (!container) {
                console.error('Container element not found');
                return;
            }

            // 既存の接続線を削除
            const existingLines = container.querySelectorAll('.connection-line');
            existingLines.forEach(line => line.remove());

            let connectionCount = 0;
            connections.forEach(conn => {
                const fromElement = document.getElementById(conn.from);
                const toElement = document.getElementById(conn.to);

                if (fromElement && toElement) {
                    const fromRect = {
                        left: fromElement.offsetLeft,
                        top: fromElement.offsetTop,
                        width: fromElement.offsetWidth,
                        height: fromElement.offsetHeight
                    };
                    const toRect = {
                        left: toElement.offsetLeft,
                        top: toElement.offsetTop,
                        width: toElement.offsetWidth,
                        height: toElement.offsetHeight
                    };

                    const x1 = fromRect.left + fromRect.width / 2;
                    const y1 = fromRect.top + fromRect.height;
                    const x2 = toRect.left + toRect.width / 2;
                    const y2 = toRect.top;

                    // 線の長さと角度を計算
                    const dx = x2 - x1;
                    const dy = y2 - y1;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;

                    // CSS線要素を作成
                    const line = document.createElement('div');
                    line.className = 'connection-line';
                    line.style.left = x1 + 'px';
                    line.style.top = y1 + 'px';
                    line.style.width = length + 'px';
                    line.style.transform = `rotate(${angle}deg)`;

                    container.appendChild(line);
                    connectionCount++;
                }
            });

            console.log("Created " + connectionCount + " CSS lines");
        }

        window.onload = function() {
            hierarchicalLayout();

            // コンテナの高さを動的に設定
            const treeStructure = analyzeTreeStructure(nodes, connections);
            const container = document.getElementById('treeContainer');
            const requiredHeight = Math.max(800, treeStructure.levels.length * 80 + 100);

            container.style.height = requiredHeight + 'px';

            // デバッグ：実際の要素幅と計算値を比較
            setTimeout(() => {
                debugActualWidths();
                createCSSLines();
            }, 200);
        };

        function debugActualWidths() {
            const nodeWidthMap = calculateAllNodeWidths(nodes);

            nodes.forEach(node => {
                const element = document.getElementById(node.id);
                if (element && node.label.length > 10) {
                    const actualWidth = element.offsetWidth;
                    const calculatedWidth = nodeWidthMap.get(node.label);
                    const difference = actualWidth - calculatedWidth;

                    console.log("Width comparison: " + node.label);
                    console.log("  Calculated: " + calculatedWidth + "px, Actual: " + actualWidth + "px, Difference: " + difference + "px");
                }
            });
        }
    </script>
</body>
</html>